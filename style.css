/* =========================================================
   Blurb — Loud & Playful (Flat Colors, Cream base)
   Keeps your class names. No gradients anywhere.
   ========================================================= */

/* ---- Palette ---- */
:root {
  /* base */
  --cream: #f6efe3;
  --text-dark: #1e1c23;
  --text-light: #ffffff;
  --muted: #5c5968;
  --card: #ffffff;
  --stroke: rgba(0,0,0,.08);

  --radius-xxl: 32px;

  /* brand (flat) */
  --happy: #ffd400;  /* yellow */
  --bat:   #7f27a8;  /* purple */
  --pond:  #53b0c9;  /* teal */
  --juice: #f76400;  /* orange */
  --heart: #c1008f;  /* magenta */
  --cheek: #e885cf;  /* pink */

  /* accessible on-colors */
  --on-happy: var(--text-dark);
  --on-bat:   var(--text-light);
  --on-pond:  var(--text-light);
  --on-juice: var(--text-dark);
  --on-heart: var(--text-light);
  --on-cheek: var(--text-dark);

  /* roles (you can swap with theme classes below) */
  --primary: var(--happy);
  --on-primary: var(--on-happy);
  --hero: var(--happy);   /* top “phone” panel color */
}

/* optional theme switchers (add to <body>) */
.theme-happy { --primary: var(--happy); --on-primary: var(--on-happy); --hero: var(--happy); }
.theme-bat   { --primary: var(--bat);   --on-primary: var(--on-bat);   --hero: var(--bat); }
.theme-pond  { --primary: var(--pond);  --on-primary: var(--on-pond);  --hero: var(--pond); }
.theme-juice { --primary: var(--juice); --on-primary: var(--on-juice); --hero: var(--juice); }
.theme-heart { --primary: var(--heart); --on-primary: var(--on-heart); --hero: var(--heart); }
.theme-cheek { --primary: var(--cheek); --on-primary: var(--on-cheek); --hero: var(--cheek); }

/* ---- Base ---- */
* { box-sizing: border-box; }
html, body { height: 100%; margin: 0; }
body {
  background: var(--cream);
  color: var(--text-dark);
  font-family: "Fredoka","Nunito",ui-sans-serif,system-ui,Arial;
  line-height: 1.3;
}

/* layout */
.page { min-height: 100%; display: grid; place-items: center; padding: 40px 20px; }
.splash { width: min(560px, 92vw); }
.card, .auth-card {
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: var(--radius-xxl);
  box-shadow: 0 24px 60px rgba(0,0,0,.06);
  padding: 36px 28px 28px;
  text-align: center;
}

/* logo */
.badge { width: 132px; height: 132px; margin: 4px auto 16px; border-radius: 28px; background: var(--primary); display: grid; place-items: center; }
.brand-svg { width: 78%; height: 78%; color: var(--on-primary); }

/* text */
.title { margin: 4px 0 8px; font-weight: 900; font-size: clamp(28px, 5.5vw, 38px); letter-spacing: .2px; }
.subtitle { margin: 0 0 20px; color: var(--muted); font-weight: 700; }

/* progress bar */
.bar { --h: 18px; height: var(--h); width: 100%; border-radius: 999px; background: #f1f1f4; border: 1px solid var(--stroke); overflow: hidden; }
.bar-fill { height: 100%; width: 0%; background: var(--primary); transition: width 260ms cubic-bezier(.2,.8,.2,1); }
.percent { margin: 12px 0 0; color: var(--muted); font-weight: 700; }

/* sparkles (unchanged) */
.sparkles { position: fixed; inset: 0; pointer-events: none; z-index: 9999; }
.sparkles .star { position: absolute; color: var(--primary); text-shadow: 0 0 6px rgba(255,255,255,.7); opacity: 0; }

/* misc */
.noscript { margin: 16px; padding: 12px 16px; background: #ffd8d6; color: #5b0b00; border-radius: 12px; }

/* auth */
.auth { width: min(550px, 92vw); margin: 12px auto; }
.auth-card { padding: 22px; box-shadow: 0 24px 60px rgba(0,0,0,.05); text-align: left;}

/* Explicit left alignment for the pieces you called out */
.auth-card .form-row label,
.auth-card .hint,
.auth-card .reqs,
.auth-card .form-status,
.auth-card .alt-action {
  text-align: left;
}

/* Small spacing tidy-ups */
.auth-card .panel { 
  max-width: 560px; 
  margin: 0 auto;
}
.auth-card .alt-action { 
  margin-top: 12px; 
}


/* tabs */
.tabs { display: flex; gap: 8px; justify-content: center; margin-bottom: 10px; }
.tab {
  appearance: none; border: 1px solid var(--stroke); background: #fff;
  padding: 10px 16px; border-radius: 999px; font-weight: 900; cursor: pointer; color: var(--muted);
}
.tab.is-active { background: var(--primary); color: var(--on-primary); border-color: var(--primary); }

.panel { margin-top: 8px; }
.panel.is-hidden { display: none; }

/* forms */
.form-row { margin: 14px 0; }
.form-row label { display: block; font-weight: 900; margin: 0 0 6px; }
.input-with-btn { display: flex; gap: 8px; }

input[type="email"], input[type="password"], input[type="text"] {
  width: 100%; padding: 12px 14px; border-radius: 16px;
  border: 1px solid var(--stroke); background: #fff; color: var(--text-dark); font: inherit;
}
input:focus { outline: none; box-shadow: 0 0 0 3px rgba(0,0,0,.05); border-color: var(--primary); }

.ghost-btn { border: 1px solid var(--stroke); background: #fff; color: var(--text-dark); padding: 0 12px; border-radius: 12px; font-weight: 900; cursor: pointer; }

.row-flex { display: flex; align-items: center; justify-content: space-between; gap: 10px; }
.checkbox { display: flex; align-items: center; gap: 10px; cursor: pointer; }
.checkbox input { width: 18px; height: 18px; }

/* primary button */
.primary-btn {
  width: 100%; padding: 12px 14px; border-radius: 18px; border: 1px solid var(--primary);
  cursor: pointer; font-weight: 900; color: var(--on-primary); background: var(--primary);
  box-shadow: 0 6px 16px rgba(0,0,0,.08);
}

/* links */
.link { background: none; border: none; color: var(--bat); text-decoration: underline; cursor: pointer; font-weight: 900; }

/* strength meter (flat) */
.strength { height: 8px; width: 100%; border-radius: 999px; background: #f1f1f4; border: 1px solid var(--stroke); overflow: hidden; margin-top: 8px; }
.strength-fill { height: 100%; width: 0%; background: var(--primary); transition: width 200ms ease; }

/* req list */
.reqs { list-style: none; padding: 8px 0 0; margin: 0; display: grid; gap: 6px; color: var(--muted); }
.reqs li { display: flex; align-items: center; gap: 8px; }
.reqs li::before { content: "✗"; color: #b34a4a; font-weight: 900; }
.reqs li.ok { color: #1f6a48; }
.reqs li.ok::before { content: "✓"; color: #1f6a48; }

.hint { margin: 6px 0 0; min-height: 1.2em; color: var(--muted); }
.form-status { margin-top: 10px; min-height: 1.4em; font-weight: 900; }

.sr-only {
  position: absolute !important; width: 1px; height: 1px; padding: 0; margin: -1px;
  overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0;
}

/* ---- Onboarding “phone card” ---- */
.pref-shell { position: relative; width: min(440px, 92vw); margin-inline: auto; padding: 32px 0 28px; }
.pref-card {
  position: relative; margin: 14px; padding: 18px 18px 20px; border-radius: 28px;
  background: var(--card); border: 1px solid var(--stroke); box-shadow: 0 20px 46px rgba(0,0,0,.10);
}

/* Step progress (2/4) */
/* Top step progress (centered, shorter width) */
.flow-progress {
  width: 60%;              /* shorter bar */
  max-width: 480px;        /* prevents it from getting huge */
  margin: 20px auto 24px;  /* centers it */
  text-align: center;
}

/* Bigger but still secondary to page title */
.flow-meta {
  font-weight: 800;
  font-size: 1rem;         /* was .85rem */
  color: var(--text);
  margin-bottom: 8px;
  letter-spacing: -0.2px;
}

/* Progress bar container */
.flow-bar {
  height: 10px;
  background: #ebe8e0;
  border-radius: 999px;
  overflow: hidden;
  border: 1px solid var(--stroke);
}

/* Filling section */
.flow-fill {
  height: 100%;
  background: var(--primary);
  border-radius: inherit;
  transition: width .3s ease;
}

.flow-fill.step-2 { width: 50%; }
.flow-fill.step-3 { width: 75%; }
.flow-fill.step-4 { width: 100%; }


/* header */
.pref-top { display: flex; align-items: center; gap: 12px; padding: 2px 2px 10px; }
.icon-btn {
  appearance: none; border: 1px solid var(--stroke); background: var(--card); color: var(--text-dark);
  width: 36px; height: 36px; border-radius: 999px; cursor: pointer; font-weight: 900; font-size: 18px; line-height: 1;
}
.pref-title { margin: 0; font-weight: 900; font-size: 24px; letter-spacing: .2px; color: var(--text-dark); }
.pref-sub { margin: .25rem 0 0; color: var(--muted); font-weight: 700; font-size: .92rem; }

/* progress */
.pref-progress { margin: 8px 2px 12px; }
.pref-count { display: inline-block; font-weight: 900; font-size: .85rem; color: var(--muted); margin-bottom: 6px; }
.pill { height: 12px; width: 100%; background: #f1f1f4; border: 1px solid var(--stroke); border-radius: 999px; overflow: hidden; }
.pill-fill { height: 100%; width: 0%; background: var(--juice); transition: width .22s ease; }

/* chips */
.chip-group { display: grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap: 10px; margin: 10px 0 16px; }
@media (max-width: 430px) { .chip-group { grid-template-columns: repeat(2, minmax(0,1fr)); } }

.chip{
  display: inline-flex; align-items: center; justify-content: center; gap: 8px;
  padding: 10px 12px; border-radius: 999px; border: 1px solid var(--stroke);
  background: #fff; color: var(--text-dark); cursor: pointer; font-size: .95rem; font-weight: 900;
  box-shadow: 0 1px 0 rgba(0,0,0,.04); transition: transform .06s ease, box-shadow .18s ease, background .18s ease, border-color .18s ease;
  width: 100%;          /* take the whole grid cell */
  min-width: 0;         /* allow shrinking with the grid */
  max-width: 100%;
  white-space: normal;  /* allow line breaks */
  overflow: visible;    /* no clipping */
  text-overflow: clip;  /* no ellipsis */
  text-align: center;
  line-height: 1.15;
  padding: 12px 12px;   /* a bit taller to fit 2 lines if needed */
  min-height: 44px;     /* consistent row height */
}
.chip:hover { transform: translateY(-1px); box-shadow: 0 8px 18px rgba(0,0,0,.06); }
.chip:focus-visible { outline: 2px solid var(--primary); outline-offset: 2px; }

.pref-card .chip-group{
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
}

/* selected chips — rotate through brand colors via nth-child */
.chip.selected { border-color: transparent; box-shadow: 0 10px 22px rgba(0,0,0,.10); }
#hobbyChoices .chip.selected:nth-child(6n+1),
#genreChoices .chip.selected:nth-child(6n+1) { background: var(--happy); color: var(--on-happy); }
#hobbyChoices .chip.selected:nth-child(6n+2),
#genreChoices .chip.selected:nth-child(6n+2) { background: var(--bat);   color: var(--on-bat); }
#hobbyChoices .chip.selected:nth-child(6n+3),
#genreChoices .chip.selected:nth-child(6n+3) { background: var(--pond);  color: var(--on-pond); }
#hobbyChoices .chip.selected:nth-child(6n+4),
#genreChoices .chip.selected:nth-child(6n+4) { background: var(--juice); color: var(--on-juice); }
#hobbyChoices .chip.selected:nth-child(6n+5),
#genreChoices .chip.selected:nth-child(6n+5) { background: var(--heart); color: var(--on-heart); }
#hobbyChoices .chip.selected:nth-child(6n+6),
#genreChoices .chip.selected:nth-child(6n+6) { background: var(--cheek); color: var(--on-cheek); }
.chip.selected::after { content: "✓"; margin-left: 6px; font-weight: 900; }

/* buttons */
.btn { font: inherit; padding: 12px 16px; border-radius: 14px; border: 1px solid var(--stroke); background: #fff; cursor: pointer; }
.btn-primary { background: var(--primary); border-color: var(--primary); color: var(--on-primary); }
.btn-ghost { background: transparent; }
.btn:disabled { opacity: .5; cursor: not-allowed; }
.actions { display: flex; gap: 12px; }
.pref-step.is-hidden { display: none; }

/* stepper (if used elsewhere) */
.stepper { display: flex; align-items: center; gap: 8px; margin: 8px 0 16px; }
.stepper .divider { flex: 1; height: 2px; background: var(--stroke); border-radius: 99px; }
.stepper .step { font-size: .9rem; padding: 6px 10px; border-radius: 999px; border: 1px solid var(--stroke); background: #fff; color: var(--muted); }
.stepper .step.is-active { background: var(--primary); color: var(--on-primary); border-color: var(--primary); }

/* tidy outer page */
.page { padding: 32px 12px; }

/* Falling emoji pop when selecting a chip */
.float-emoji{
  position: fixed;
  left: 0; top: 0;
  pointer-events: none;
  font-size: 24px;
  filter: drop-shadow(0 4px 6px rgba(0,0,0,.12));
  animation: floatFall 700ms ease-out forwards;
  z-index: 9999;
}

@keyframes floatFall{
  0%   { transform: translate(0,0) scale(.9); opacity: 1; }
  70%  { transform: translate(var(--dx, 0px), 70px) scale(1.05); opacity: .95; }
  100% { transform: translate(var(--dx, 0px), 110px) scale(.95); opacity: 0; }
}

/* =========================================================
   Avatar grid: force circle tiles (override global .chip)
   ========================================================= */
#pref-step-avatars .avatar-grid {
  display: grid !important;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
}

#pref-step-avatars .avatar-hero {
  display: grid;
  grid-template-columns: 40px 1fr auto; /* back btn | text | continue btn */
  align-items: center;
  position: relative;
}

/* Center the emoji by making it span all columns */
#pref-step-avatars .hero-emoji {
  grid-column: 1 / -1;        /* spans full width */
  justify-self: center;       /* horizontal center */
  margin: 10px 0 4px;
}

/* Hard override the chip look only in the avatar grid */
#pref-step-avatars .avatar-grid .chip.avatar-card {
  /* nuke pill-row behavior */
  display: grid !important;
  place-items: center !important;
  padding: 0 !important;
  margin: 0 !important;
  width: 100% !important;
  aspect-ratio: 1 / 1 !important;
  border-radius: 9999px !important;

  /* visual style */
  border: 2px solid var(--bat) !important;
  background: #fff !important;
  box-shadow: 0 2px 6px rgba(0,0,0,.06) !important;
  cursor: pointer !important;
  position: relative !important;

  /* kill any leftover flex/text formatting from .chip */
  line-height: 1 !important;
  justify-content: center !important;
  align-items: center !important;
  text-align: center !important;
}

/* Emoji + labels */
#pref-step-avatars .hero-emoji {
  font-size: clamp(140px, 28vw, 220px); /* larger than before */
  margin-block: 4px 6px;
}

#pref-step-avatars .avatar-grid .chip.avatar-card .emoji {
  font-size: 28px;
  line-height: 1;
  pointer-events: none;
}

#pref-step-avatars .avatar-grid .chip.avatar-card .cost {
  position: absolute;
  bottom: 6px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 11px;
  opacity: .8;
}
#pref-step-avatars .avatar-grid .chip.avatar-card .cost.free { opacity: .6; }

#pref-step-avatars .avatar-grid .chip.avatar-card .lock {
  position: absolute;
  font-size: 22px;
  color: var(--bat);
  opacity: .9;
  right: 8px;
  top: 8px;
  pointer-events: none;
}

/* Avatar hover glow */
#pref-step-avatars .avatar-grid .chip.avatar-card:hover:not(.is-locked) {
  box-shadow: 0 0 0 4px var(--bat), 0 0 18px var(--bat) !important; /* <-- add !important */
  transform: translateY(-2px) !important;
  border-color: var(--bat) !important;
  z-index: 2;
}

/* Selected state glow */
#pref-step-avatars .avatar-grid .chip.avatar-card.selected {
  box-shadow: 0 0 0 5px var(--bat), 0 0 22px var(--bat) !important; /* <-- add !important */
  border-color: var(--bat) !important;
}


/* Locked look */
#pref-step-avatars .avatar-grid .chip.avatar-card.is-locked {
  opacity: .75;
}
#pref-step-avatars .avatar-grid .chip.avatar-card.is-locked .emoji {
  filter: grayscale(.2);
}

#pref-step-avatars .hero-emoji.animate {
  animation: pop 250ms ease-out;
}

@keyframes pop {
  0%   { transform: scale(.6); opacity: .4; }
  100% { transform: scale(1); opacity: 1; }
}

/* ===== Remove any tick/check added by global .chip styles ONLY in Step 4 ===== */
#pref-step-avatars .avatar-grid .chip.avatar-card.selected::after,
#pref-step-avatars .avatar-grid .chip.avatar-card.selected::before {
  content: none !important;
  display: none !important;
  background: none !important;
  mask: none !important;
  -webkit-mask: none !important;
}

/* Some kits add the tick as a background on the button itself */
#pref-step-avatars .avatar-grid .chip.avatar-card.selected {
  background-image: none !important;
}


/* Responsive: 3 columns on narrow screens */
@media (max-width: 420px) {
  #pref-step-avatars .avatar-grid { grid-template-columns: repeat(3, 1fr); }
}